from django import forms
from django.forms import ModelForm

from .models import {% for i in models %}{{i.new_name|upper}} {% if loop.last %}{% else %},{% endif %}{% endfor %}

from django.contrib.auth.forms import UserCreationForm
from django.contrib.auth.models import User



from .json_import import PRICE_TABLE


def ajax_init(request,form_name=False,field=False):
    request.session.modified = True
    field_Name = field['name']
    field_data = field['initial']
    field_type = field['type']
    price = 0
    current = 0
    try:
        session = request.session[form_name]
    except KeyError:
        request.session[form_name] = {}
        session = request.session[form_name]
    try:
        price = PRICE_TABLE[field_Name][field_data]['price']
    except KeyError:
        price = PRICE_TABLE[field_Name][field_data]['value']
    try:
         current = float(field_data) *  price
    except Exception as e:
         current = price *  1
    value = field_data
    if field_type == 'checkbox':
        if field_data:
            value = 'on,'
        else:
            value = ''
    try:
        session[field_Name] = { 'price' : price , 'value' : value , 'current' : current }
    except KeyError:
        session[field_Name] = { 'price' : price , 'value' : value , 'current' : current }


{% for i in forms %}
{{i.render}}


{% endfor %}




class SignUpForm(UserCreationForm):
    email = forms.EmailField(max_length=254, help_text='Required. Inform a valid email address.')

    class Meta:
        model = User
        fields = ( 'email', 'password1', 'password2', )

class UserChangeForm(forms.ModelForm):
    class Meta:
        model = User
        fields = ( 'first_name','last_name')
